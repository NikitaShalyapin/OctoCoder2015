function Program
%fid = fopen( 'beacon1ch.sig', 'r' );
    fid = fopen( 'beacons2.sig', 'r' );
    if(fid == -1)
        error( 'File is not opened' )
    end
    
Signal = fread(fid,'int16');
fclose(fid);

l = length(Signal);
j = 1;
for i = 1:4:l-3
    sig1(j,1) = complex(Signal(i),Signal(i+1));
    sig2(j,1) = complex(Signal(i+2),Signal(i+3));
    j = j+1;
end
PRS=[     1,  1,  1,  1,  1,  1, -1, -1, -1, -1,  1,  1,  1,  1, -1,  1,  1,  1, -1, -1, -1, -1,  1, -1,  1,  1, -1, -1,  1,  1, -1,  1, ...
          1, -1,  1,  1,  1,  1, -1,  1, -1, -1, -1, -1,  1,  1,  1, -1, -1,  1,  1, -1, -1, -1, -1,  1, -1, -1,  1, -1, -1, -1,  1, -1, ...
          1, -1,  1,  1,  1, -1,  1, -1,  1,  1,  1,  1, -1, -1,  1, -1, -1,  1, -1,  1,  1,  1, -1, -1,  1,  1,  1, -1, -1, -1, -1, -1, ...
         -1,  1,  1,  1, -1,  1,  1,  1, -1,  1, -1, -1,  1,  1,  1,  1, -1,  1, -1,  1, -1, -1,  1, -1,  1, -1, -1, -1, -1, -1, -1,  1, ...
         -1,  1, -1,  1, -1,  1, -1,  1,  1,  1,  1,  1, -1,  1, -1,  1,  1, -1,  1, -1, -1, -1, -1, -1,  1,  1, -1,  1,  1,  1, -1,  1, ...
          1, -1,  1,  1, -1,  1, -1,  1,  1, -1, -1, -1, -1, -1,  1, -1,  1,  1,  1, -1,  1,  1,  1,  1,  1, -1, -1, -1,  1,  1,  1,  1, ...
         -1, -1,  1,  1, -1,  1, -1, -1,  1,  1, -1,  1, -1,  1,  1,  1, -1, -1, -1,  1,  1, -1,  1, -1, -1, -1,  1, -1,  1,  1,  1,  1, ...
          1,  1,  1, -1,  1, -1, -1,  1, -1,  1,  1, -1, -1, -1,  1, -1,  1, -1, -1,  1,  1, -1, -1, -1,  1,  1, -1, -1, -1, -1, -1, -1, ...
         -1,  1,  1, -1, -1,  1,  1, -1, -1,  1, -1,  1, -1,  1,  1, -1, -1,  1, -1, -1,  1,  1,  1,  1,  1,  1, -1,  1,  1, -1,  1, -1, ...
         -1,  1, -1, -1,  1, -1, -1,  1,  1, -1,  1,  1,  1,  1,  1,  1, -1, -1,  1, -1,  1,  1, -1,  1, -1,  1, -1, -1, -1, -1,  1, -1, ...
          1, -1, -1, -1,  1, -1, -1,  1,  1,  1, -1,  1,  1, -1, -1,  1, -1,  1,  1,  1,  1, -1,  1,  1, -1, -1, -1, -1,  1,  1, -1,  1, ...
         -1,  1, -1,  1, -1, -1,  1,  1,  1, -1, -1,  1, -1, -1, -1, -1,  1,  1, -1, -1, -1,  1, -1, -1, -1, -1,  1, -1, -1, -1, -1, -1, ...
         -1, -1, -1,  1, -1, -1, -1,  1, -1, -1, -1,  1,  1, -1, -1,  1, -1, -1, -1,  1,  1,  1, -1,  1, -1,  1, -1,  1,  1, -1,  1,  1, ...
         -1, -1, -1,  1,  1,  1, -1, -1, -1,  1, -1, -1,  1, -1,  1, -1,  1, -1, -1, -1,  1,  1, -1,  1,  1, -1, -1,  1,  1,  1,  1,  1, ...
         -1, -1,  1,  1,  1,  1, -1, -1, -1,  1, -1,  1,  1, -1,  1,  1,  1, -1, -1,  1, -1,  1, -1, -1,  1, -1, -1, -1, -1, -1,  1, -1, ...
         -1,  1,  1, -1, -1,  1,  1,  1, -1,  1, -1, -1, -1,  1,  1,  1,  1,  1, -1,  1,  1,  1,  1, -1, -1, -1, -1, -1,  1,  1,  1];

    l=length(PRS);
    iteration=length(sig1)-l;
    for i=0:1:iteration
        corr_comp=0;
        for j=1:1:l
            corr_comp=corr_comp+PRS(j)*sig1(j+i,1);
        end
        corr(i+1)=abs(corr_comp);
    end
    
[max_c,nom] = max(corr)
%plot(corr);

g = corr(length(max_c)+l:1:length(max_c)+l+1535);
   %Умножение пакета на псевдослучайную последовательность
    g(1:l)=g(1:l)*PRS(j);
    g(l:2*l)=g(l:2*l)*PRS(j);
    g(2*l:3*l)=g(2*l:3*l)*PRS(j);
    g(3*l:3*l+3)=g(3*l:3*l+3)*PRS(j);
    
    Matrix = HADAMARD(64);
    y = 0:64:length(g);

    for n = 1:24
        k = 0;
        for s = 1:length(Matrix) 
            k(s)=corr2(g(y(n)+1:y(n+1)),Matrix(s,:));
        end
        [v, i] = max(k);
        h(n) = i;
    end
result = h
end