function Program
fid = fopen( 'beacon1ch.sig', 'r' );
%fid = fopen( 'beacons2.sig', 'r' );
if(fid == -1)
  error( 'File is not opened' )
end
Signal=fread(fid,'int16');
fclose(fid);
l=length(Signal);
j=1;
for i=1:4:l-3
    sig1(j,1)=complex(Signal(i),Signal(i+1));
    sig2(j,1)=complex(Signal(i+2),Signal(i+3));
    j=j+1;
end
PRS=[     1,  1,  1,  1,  1,  1, -1, -1, -1, -1,  1,  1,  1,  1, -1,  1,  1,  1, -1, -1, -1, -1,  1, -1,  1,  1, -1, -1,  1,  1, -1,  1, ...
          1, -1,  1,  1,  1,  1, -1,  1, -1, -1, -1, -1,  1,  1,  1, -1, -1,  1,  1, -1, -1, -1, -1,  1, -1, -1,  1, -1, -1, -1,  1, -1, ...
          1, -1,  1,  1,  1, -1,  1, -1,  1,  1,  1,  1, -1, -1,  1, -1, -1,  1, -1,  1,  1,  1, -1, -1,  1,  1,  1, -1, -1, -1, -1, -1, ...
         -1,  1,  1,  1, -1,  1,  1,  1, -1,  1, -1, -1,  1,  1,  1,  1, -1,  1, -1,  1, -1, -1,  1, -1,  1, -1, -1, -1, -1, -1, -1,  1, ...
         -1,  1, -1,  1, -1,  1, -1,  1,  1,  1,  1,  1, -1,  1, -1,  1,  1, -1,  1, -1, -1, -1, -1, -1,  1,  1, -1,  1,  1,  1, -1,  1, ...
          1, -1,  1,  1, -1,  1, -1,  1,  1, -1, -1, -1, -1, -1,  1, -1,  1,  1,  1, -1,  1,  1,  1,  1,  1, -1, -1, -1,  1,  1,  1,  1, ...
         -1, -1,  1,  1, -1,  1, -1, -1,  1,  1, -1,  1, -1,  1,  1,  1, -1, -1, -1,  1,  1, -1,  1, -1, -1, -1,  1, -1,  1,  1,  1,  1, ...
          1,  1,  1, -1,  1, -1, -1,  1, -1,  1,  1, -1, -1, -1,  1, -1,  1, -1, -1,  1,  1, -1, -1, -1,  1,  1, -1, -1, -1, -1, -1, -1, ...
         -1,  1,  1, -1, -1,  1,  1, -1, -1,  1, -1,  1, -1,  1,  1, -1, -1,  1, -1, -1,  1,  1,  1,  1,  1,  1, -1,  1,  1, -1,  1, -1, ...
         -1,  1, -1, -1,  1, -1, -1,  1,  1, -1,  1,  1,  1,  1,  1,  1, -1, -1,  1, -1,  1,  1, -1,  1, -1,  1, -1, -1, -1, -1,  1, -1, ...
          1, -1, -1, -1,  1, -1, -1,  1,  1,  1, -1,  1,  1, -1, -1,  1, -1,  1,  1,  1,  1, -1,  1,  1, -1, -1, -1, -1,  1,  1, -1,  1, ...
         -1,  1, -1,  1, -1, -1,  1,  1,  1, -1, -1,  1, -1, -1, -1, -1,  1,  1, -1, -1, -1,  1, -1, -1, -1, -1,  1, -1, -1, -1, -1, -1, ...
         -1, -1, -1,  1, -1, -1, -1,  1, -1, -1, -1,  1,  1, -1, -1,  1, -1, -1, -1,  1,  1,  1, -1,  1, -1,  1, -1,  1,  1, -1,  1,  1, ...
         -1, -1, -1,  1,  1,  1, -1, -1, -1,  1, -1, -1,  1, -1,  1, -1,  1, -1, -1, -1,  1,  1, -1,  1,  1, -1, -1,  1,  1,  1,  1,  1, ...
         -1, -1,  1,  1,  1,  1, -1, -1, -1,  1, -1,  1,  1, -1,  1,  1,  1, -1, -1,  1, -1,  1, -1, -1,  1, -1, -1, -1, -1, -1,  1, -1, ...
         -1,  1,  1, -1, -1,  1,  1,  1, -1,  1, -1, -1, -1,  1,  1,  1,  1,  1, -1,  1,  1,  1,  1, -1, -1, -1, -1, -1,  1,  1,  1];
l=length(PRS);
iteration=length(sig2)-l;
for i=0:1:iteration
    corr_comp=0;
    for j=1:1:l
        corr_comp=corr_comp+PRS(j)*sig2(j+i,1);
    end
    corr(i+1)=abs(corr_comp);
end
[max_c,nom]=max(corr);

%Сужение спектра
package=sig2(nom+511:nom+2046);
m=cat(2,PRS,PRS,PRS,PRS(1:3));
package=package'.*m;
w=hadamard(64);
%pac=reshape(package,64,24)';
for i=1:1:24
    pac(i,:)=package((i-1)*64+1:i*64);
end
for i=1:1:24
    for j=1:1:64
        corr_w(j)=abs(sum(w(j,:).*pac(i,:)));
    end
    %plot(corr_w)
    %input('Next***********************************')
    [max_c,nom]=max(corr_w);
    res(i)=nom-1;
end
%res массив чисел, полученный после сужения спектра

%Декодер Витерби
bit_res=de2bi(res);
bit_res=bit_res(:,[6,5,4,3,2,1])';
bit=bit_res(:)';
trellis=poly2trellis([9 9],[753; 561]);
code=vitdec(bit,trellis,3,'trunc','hard');
end